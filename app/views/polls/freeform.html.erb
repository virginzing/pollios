<section id="widget-grid" class="">
  <div class="row">
    <div class="col-md-12">
      <div class="jarviswidget" id="wid-id-0" data-widget-colorbutton="false" data-widget-editbutton="false">

      <header>
        <span class="widget-icon"> <i class="fa fa-edit"></i> </span>
        <h2><strong>Form</strong></h2>       
        
      </header>
      <!-- widget div-->
      <div>
    
        <!-- widget content -->
        <div class="widget-body">
          <%= simple_form_for @poll, :html => { :multipart => true, class: "smart-form", id: "form-input" } do |f| %>
          <%= f.input :type_poll, as: :hidden, input_html: { value: "freeform" } %>
          <header>
            Poll Detail 
          </header>

          <fieldset>
              
            <section>
              <div class="row">
                <section class="col col-10">
                  <label class="label">Question</label>
                  <label class="textarea">
                    <textarea class="maxlength_textarea" id="textarea3" rows="5" name="poll[title_with_tag]" maxlength="250" required data-parsley-range="[5,250]" style="display: block; width: 100%;"></textarea>
                  </label>
                  <div class="note">
                    <strong>Note: </strong> use tag by '#'
                  </div>
                </section>

                <section class="col col-2">
                  <label class="label">Expire with in</label>
                  <label class="select">
                    <%= f.input :expire_date, collection: 1..20, label: false, include_blank: false %>
                    <i></i>
                  </label>
                </section>

              </div>
            </section>

            <section>
              <label class="label">Choice</label>
              <label class="input">
                <%= f.input :choice_one, label: false, input_html: { :"data-parsley-required" => "true" }  %>
              </label>
            </section>

              <div id="InputsWrapper">
                <section>
                  <label class="label">Choice</label>
                  <label class="input">
                    <input type="text" name="choices[]" class="string optional form-control form-choice-list" id="field_1" required>
                    <a href="#" class="removeclass"></a>
                  </label>
                </section>
              </div>
            
            <button type="button" class="add-field btn btn-sm btn-default" id="AddMoreFileBox" style="margin-bottom: 10px;">More choice</button>
          

          </fieldset>

          <header>
            Config
          </header>
          
          <fieldset>
            <section>
              <label class="label">Campaign</label>
              <label class="select">
                <%= f.select :campaign_id, Campaign.all.map! {|r| [r.name, r.id ] }, { include_blank: true },  { class: 'select2', placeholder: "Select a campaign"} %>
              </label>
            </section>

            <section>
              <label class="label">Recurring</label>
              <label class="select">
                <%= f.select :recurring_id, list_recurring.map! { |r| [ r.description + " รันทุกๆ  " + r.period.strftime("%H:%M") + " น.", r.id.to_i]}, { include_blank: true },  { class: 'select2', placeholder: "Select a recurring"} %>
              </label>
            </section>
          
          </fieldset>
        

          <footer>
            <button type="submit" class="btn btn-primary">
              Submit
            </button>
            <button type="button" class="btn btn-default" onclick="window.history.back();">
              Back
            </button>
          </footer>
            <% end %>

        </div>
        <!-- end widget content -->
        
      </div>
      <!-- end widget div -->
      </div>
    </div>
  </div>
</section>



<script type="text/javascript">
  $("#form-input").parsley();
</script>

<script>
$(document).ready(function() {
  var MaxInputs       = 10; //maximum extra input boxes allowed
  var InputsWrapper   = $("#InputsWrapper"); //Input boxes wrapper ID
  var AddButton       = $("#AddMoreFileBox"); //Add button ID

  var x = InputsWrapper.length; //initlal text box count
  var FieldCount=1; //to keep track of text box added

  //on add input button click
  $(AddButton).click(function (e) {
    //max input box allowed
    if(x <= MaxInputs) {
        FieldCount++; //text box added ncrement
        //add input box
        $(InputsWrapper).append('<section><label class="label">Choice</label><label class="input"><input type="text" name="choices[]" class="string optional form-control form-choice-list" id="field_1" value="" required><a href="#" class="removeclass"><i class="fa fa-trash-o"></i> Remove</a></label></section>');
        x++; //text box increment
        
        $("#AddMoreFileId").show();
        
        $('AddMoreFileBox').html("Add field");
        
        // Delete the "add"-link if there is 3 fields.
        if(x == 10) {
          $("#AddMoreFileId").hide();
          $("#lineBreak").html("<br>");
        }
    }
    return false;
  });

  $("body").on("click",".removeclass", function(e){ //user click on remove text
    if( x > 1 ) {
      $(this).parent('label').parent('section').remove(); // remove text bok
      // console.log($(this).parent('label').parent('section').remove());
      x--; //decrement textbox

    $("#AddMoreFileId").show();

    $("#lineBreak").html("");

    // Adds the "add" link again when a field is removed.
    $('AddMoreFileBox').html("Add field");
      }
      return false;
    }) 
});
</script>
