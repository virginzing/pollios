<div class="portlet box yellow">
  <div class="portlet-title">
     <div class="caption"><i class="icon-reorder"></i>Campaign</div>
     <div class="tools">
        <a href="javascript:;" class="collapse"></a>
        <a href="javascript:;" class="remove"></a>
     </div>
  </div>
  <div class="portlet-body">
    <%= simple_form_for @campaign, :html => { :multipart => true, class: "form-horizontal", id: "campaign-form" } do |f| %>
      <div class="form-body">
        <div class="row">
          <div class="col-md-7">
            <%= f.input :name, wrapper: :horizontal, input_html: { data: { 'validetta' => 'required' } } %>

            <div class="form-group">
              <label class="control-label col-md-2">Poll</label>
              <div class="col-md-10">
                <%= f.select :poll_id, current_member.polls.where("polls.campaign_id = 0").order('title desc').map {|r| [r.title, r.id ]}, { include_blank: true },  { class: 'select2me_poll', placeholder: "Select a Poll"} %>
              </div>
            </div>

            <div class="form-group">
              <div class="label-hz col-md-2">
                <label class="string optional control-label" for="datetimepicker">Expire date</label>
              </div>

              <div class="col-md-4">
                <div class="input-group input-small date date-picker" data-date-format="dd-mm-yyyy" style="display: -webkit-inline-box;">
                <% if action_name == "edit" %>
                  <input class="string optional form-control input-small" id="datetimepicker" name="campaign[expire]" readonly="readonly" type="text" value="<%= @campaign.expire.strftime('%d-%m-%Y') %>" data-validetta="required">
                <% else %>
                  <input class="string optional form-control input-small" id="datetimepicker" name="campaign[expire]" readonly="readonly" type="text" data-validetta="required">
                <% end %>     
                  <span class="input-group-btn">
                    <button class="btn default" type="button"><i class="icon-calendar"></i></button>
                  </span>
                </div>
              </div>

            </div>

            <div class="form-group last">
              <label class="control-label col-md-2">Photo</label>
              <div class="col-md-10">
                 <div class="fileupload fileupload-new" data-provides="fileupload">
                    <div class="fileupload-new thumbnail" style="width: 200px; height: 150px;">
                      <% if @campaign.photo_campaign.present? %>
                        <%= image_tag(@campaign.photo_campaign.url) %>
                      <% else %>
                        <img src="http://www.placehold.it/200x150/EFEFEF/AAAAAA&amp;text=no+image" alt="" />
                      <% end %>
                    </div>
                    <div class="fileupload-preview fileupload-exists thumbnail" style="max-width: 200px; max-height: 150px; line-height: 20px;"></div>
                    <div>
                       <span class="btn default btn-file">
                       <span class="fileupload-new"><i class="icon-paper-clip"></i> Select image</span>
                       <span class="fileupload-exists"><i class="icon-undo"></i> Change</span>
                       <input type="file" class="default" name="campaign[photo_campaign]"/>
                       </span>
                       <a href="#" class="btn red fileupload-exists" data-dismiss="fileupload"><i class="icon-trash"></i> Remove</a>
                    </div>
                 </div>
              </div>
           </div>

          </div>

          <div class="col-md-4 col-md-offset-1" style="margin-left: 45px;">
            <%= f.input :begin_sample, wrapper: :horizontal ,:label => "Change", input_html: { data: { 'validetta' => "required,number" } }, required: false, as: :string %>
            <%= f.input :end_sample, wrapper: :horizontal ,:label => "Total", input_html: { data: { 'validetta' => "required,number" } }, required: false, as: :string %>
            <%= f.input :limit, wrapper: :horizontal ,:label => "Limit", input_html: { data: { 'validetta' => 'required,number' } }, as: :string, required: false %>
          </div>

        </div>
      </div>

    <div class="form-actions fluid">
      <div class="row">
         <div class="col-md-7">
            <div class="col-md-offset-2 col-md-9">
              <button type="submit" class="btn blue"><i class="icon-ok"></i> Submit</button>
              <%= link_to 'Discard', campaigns_path, method: :get, class: 'btn default' %>                              
            </div>
         </div>
         <div class="col-md-6">
         </div>
      </div>
    </div>
    <% end %>
  </div>
</div>

<script type="text/javascript">
$( document ).ready(function() {
  $(".select2me_poll").select2("data", <%= raw @poll_campaigns %>);
});
</script>