<section id="widget-grid" class="">
  <div class="row">
    <div class="col-md-12">
      <div class="jarviswidget jarviswidget-color-blueDark" id="wid-id-0" data-widget-colorbutton="false" data-widget-editbutton="false">

      <header>
        <span class="widget-icon"> <i class="fa fa-edit"></i> </span>
        <h2><strong>Form</strong></h2>       
        
      </header>
      <!-- widget div-->
      <div>
    
        <!-- widget content -->
        <div class="widget-body">
          <%= simple_nested_form_for @poll_series, :html => { :multipart => true, class: "smart-form", id: "form-input" } do |f| %>
          <%= f.input :type_series, wrapper: :horizontal, input_html: { value: 0 }, as: :hidden %>
          <header>
            Questionnaire Detail 
          </header>

          <fieldset>
            
            <section class="col col-10">
              <label class="label">Description</label>
              <label class="textarea">
                <%= f.input :description, label: false, input_html: { autofocus: "autofocus"}, required: false %>
              </label>
              <div class="onoffswitch-container" style="margin-left: 0px;">
                <span class="onoffswitch-title">Allow Suggest</span> 
                <span class="onoffswitch">
                  <input type="checkbox" class="onoffswitch-checkbox" name="poll_series[allow_comment]" id="autoopen" checked>
                  <label class="onoffswitch-label" for="autoopen"> 
                    <span class="onoffswitch-inner" data-swchon-text="ON" data-swchoff-text="OFF"></span> 
                    <span class="onoffswitch-switch"></span>
                  </label> 
                </span> 
              </div>
            </section>

            <section class="col col-2">
              <label class="label">Expire with in</label>
              <label class="select">
                <%= f.input :expire_within, collection: 1..20, label: false, include_blank: false %>
                <i></i>
              </label>
            </section>

          </fieldset>

          <header>
            List of Poll
          </header>

          <fieldset>
            <section>
              <%= f.fields_for :polls do |poll_form| %>
                <%= render 'poll_form',  :f => poll_form %>    
              <% end %>
              <%= f.link_to_add "More Poll", :polls, class: 'btn btn-primary add_new_poll' %>

            </section>

          </fieldset>

          <header>
            Config
          </header>
          
          <fieldset>
          
            <section>
              <label class="label">Tag</label>
              <div class="form-group">
              <%= f.input :tag_tokens, label: false, :input_html => { :class => "tag_token", :id => "tag_list_normal" } %>
              </div>
            </section>

            <section>
              <label class="label">Campaign</label>
              <label class="select">
                <%= f.select :campaign_id, Campaign.all.map! {|r| [r.name, r.id ] }, { include_blank: true },  { class: 'select2', placeholder: "Select a campaign"} %>
              </label>
            </section>
          
          </fieldset>
        

          <footer>
            <button type="submit" class="btn btn-primary">
              Submit
            </button>
            <button type="button" class="btn btn-default" onclick="window.history.back();">
              Back
            </button>
          </footer>
            <% end %>

        </div>
        <!-- end widget content -->
        
      </div>
      <!-- end widget div -->
      </div>
    </div>
  </div>
</section>


<script type="text/javascript">
  var times = 2;

  $(".remove_nested_fields")[0].style.visibility='hidden';
  $(".remove_nested_fields")[1].style.visibility='hidden';
  $(".remove_nested_fields")[2].style.visibility='hidden';

  $('.add_new_poll').click( function () {
    setTimeout(function () {
      for(var i=0; i < times; i++) {
        $(".add_new_choice").last().trigger("click");      }
      $('.remove_nested_fields').slice(-3,-2)[0].style.visibility='hidden';
      $('.remove_nested_fields').slice(-2,-1)[0].style.visibility='hidden';
      dropZonePicture();
    }, 5);
  });
</script>

