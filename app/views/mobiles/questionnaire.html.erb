<div class="well sub-header">
  <div class="text-center">
    <h2><strong><%= @questionnaire.description %></strong></h2>
    <p>for this series of questionnaire</p>
  </div>
</div>
<div class="row">

  <div class="col-xs-12 col-sm-12">
    <% unless @history_votes %>
      <form action="<%= mobile_vote_questionnaire_path %>" method="POST" class="form-horizontal" role="form" data-remote="true">
        <input type="hidden" name="id" value="<%= @questionnaire.id  %>">
        <input type="hidden" name="member_id" value="<%= current_member.id %>">

          <% @list_poll.each do |poll| %>
          <div class="well">
            <div class="poll-title">
              <%= poll.title %>
            </div>


            <div class="row row-centered">

              <% poll.choices.each_with_index do |choice, index| %>
                <div id="<%= choice.id  %>" class="<%=poll.id %> choice col-xs-2 col-centered"  onclick="ActiveBox('<%= choice.id %>', '<%=poll.id %>')">
                    <p class="text-center" style="font-size: 16px;"><%= choice.answer %></p>
                </div>
              <% end %>
            </div>

          </div>
            <input type="hidden" value="<%= poll.id %>" name="polls[]">
            <input type="hidden" val="" id="answer_<%= poll.id %>" name="choices[]">
          <% end %>

          <div class="form-group" style="padding-top: 10px;">
            <div class="row">
              <div class="col-xs-10 col-xs-offset-1">
                <button type="submit" id="submit-questionnaire" class="btn btn-primary btn-custom" data-disable-with="Loading...">SUBMIT</button>
              </div>
            </div>
          </div>
      </form>

    <% else %>
      <div class="alert alert-warning alert-block">
        <a class="close" data-dismiss="alert" href="#">Ã—</a>
        <h4 class="alert-heading">Info!</h4>
          You already vote this questionnaire.
      </div>
    <% end %>

  </div>

</div>

<script>
  disable_submit_btn();


  function ActiveBox(id, pollId){
    $("." + pollId ).removeClass( "active" );
    $("#" + id ).addClass( "active" );
    $("#answer_" + pollId).val(id);
    check_btn_submit($('.choice.active').size());
  }

  function check_btn_submit (count_check) {
    $.poll_count = $( "input[name='polls[]']" ).size();
    $.vote_count = count_check;

    console.log($.poll_count);
    console.log($.vote_count);

    if ($.poll_count == $.vote_count) {
      active_submit_btn();
    } else{
      disable_submit_btn();
    };
  }

  function active_submit_btn() {
    $("#submit-questionnaire").prop('disabled', false);
  }

  function disable_submit_btn() {
    $("#submit-questionnaire").prop('disabled', true);
  }
</script>